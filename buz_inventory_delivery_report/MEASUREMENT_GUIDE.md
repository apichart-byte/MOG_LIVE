# เทคนิคการวัดและปรับตำแหน่งสำหรับ Preprint Form

## เครื่องมือที่ต้องใช้
1. ไม้บรรทัดหรือสเกลวัด (มม./นิ้ว)
2. กระดาษ Preprint ตัวอย่าง
3. ปากกา/ดินสอสำหรับทำเครื่องหมาย
4. เครื่องพิมพ์ที่จะใช้งานจริง

## การแปลงหน่วย
- 1 นิ้ว = 25.4 มม.
- 1 นิ้ว = 72 pixels (ที่ DPI 90 ซึ่งเป็นค่า default)
- กระดาษ Letter = 8.5 x 11 นิ้ว = 612 x 792 pixels

## ขั้นตอนการวัดและตั้งค่า

### ขั้นตอนที่ 1: เตรียมกระดาษ Preprint
1. วางกระดาษ Preprint บนโต๊ะ
2. ทำเครื่องหมายมุมบนซ้ายเป็นจุดเริ่มต้น (0,0)
3. วัดจากมุมบนซ้ายไปยังตำแหน่งต่างๆ ที่ต้องการพิมพ์

### ขั้นตอนที่ 2: การวัดระยะ

#### วัดแนวนอน (Left - จากซ้ายไปขวา)
```
ตัวอย่าง:
- ขอบกระดาษซ้าย → ช่องเลขที่เอกสาร = 160 มม.
- แปลงเป็น pixels: 160 มม. ÷ 25.4 × 72 = 453 px
- ตั้งค่า doc_number_left = 453
```

#### วัดแนวตั้ง (Top - จากบนลงล่าง)
```
ตัวอย่าง:
- ขอบกระดาษบน → แถวเลขที่เอกสาร = 28 มม.
- แปลงเป็น pixels: 28 มม. ÷ 25.4 × 72 = 79 px
- ตั้งค่า doc_number_top = 79
```

### ขั้นตอนที่ 3: สร้าง Test Grid

1. สร้าง configuration ใหม่ชื่อ "Test Grid"
2. พิมพ์ทดสอบ โดยใช้ Preview Layout
3. วางกระดาษที่พิมพ์ทับบนกระดาษ Preprint
4. ส่องดูว่าตำแหน่งตรงกันหรือไม่

### ขั้นตอนที่ 4: ปรับแต่งละเอียด

#### ถ้าตำแหน่งเลื่อนไปทางขวา
- ลด Left value ลง 5-10 px

#### ถ้าตำแหน่งเลื่อนไปทางซ้าย
- เพิ่ม Left value ขึ้น 5-10 px

#### ถ้าตำแหน่งเลื่อนลงไปด้านล่าง
- ลด Top value ลง 5-10 px

#### ถ้าตำแหน่งเลื่อนขึ้นไปด้านบน
- เพิ่ม Top value ขึ้น 5-10 px

### ขั้นตอนที่ 5: ใช้ Quick Adjust

หลังจากวัดค่าคร่าวๆ แล้ว สามารถใช้ Quick Adjust เพื่อ:

1. **Move All Horizontal**: เลื่อนทุกอย่างซ้าย/ขวาพร้อมกัน
   - ใส่ค่าบวก (+10) = เลื่อนขวา 10 px
   - ใส่ค่าลบ (-10) = เลื่อนซ้าย 10 px

2. **Move All Vertical**: เลื่อนทุกอย่างขึ้น/ลงพร้อมกัน
   - ใส่ค่าบวก (+10) = เลื่อนลง 10 px
   - ใส่ค่าลบ (-10) = เลื่อนขึ้น 10 px

3. **Adjust Line Spacing**: ปรับระยะห่างระหว่างแถวสินค้า
   - ใส่ +2 ถ้าต้องการให้แถวห่างกันมากขึ้น
   - ใส่ -2 ถ้าต้องการให้แถวชิดกันมากขึ้น

4. **Adjust Font Size**: ปรับขนาดตัวอักษร
   - ใส่ +1 หรือ +2 ถ้าตัวอักษรเล็กเกินไป
   - ใส่ -1 หรือ -2 ถ้าตัวอักษรใหญ่เกินไป

## เทคนิคขั้นสูง

### การวัดตารางสินค้า

1. วัด Table Top (ตำแหน่งแถวแรก)
2. วัด Line Height โดย:
   - วัดระยะจากแถวที่ 1 → แถวที่ 2
   - แปลงเป็น pixels

3. วัดตำแหน่งแต่ละคอลัมน์ (ทั้งหมดวัดจาก Table Left):
   ```
   ตัวอย่าง:
   Table Left = 50 px
   
   คอลัมน์ที่ 1 (เลขที่) อยู่ที่ตำแหน่ง 50 px จากขอบซ้าย
   → col_no_left = 0 (เพราะเริ่มจาก Table Left)
   
   คอลัมน์ที่ 2 (รหัสสินค้า) อยู่ที่ตำแหน่ง 110 px จากขอบซ้าย
   → col_code_left = 60 (110 - 50 = 60)
   
   คอลัมน์ที่ 3 (ชื่อสินค้า) อยู่ที่ตำแหน่ง 210 px จากขอบซ้าย
   → col_name_left = 160 (210 - 50 = 160)
   ```

### การจัดการกับ Margin ของเครื่องพิมพ์

เครื่องพิมพ์บางรุ่นมี unprintable margin:

1. พิมพ์ทดสอบด้วยค่า margin = 0
2. วัดว่า content เริ่มพิมพ์จากตำแหน่งไหน
3. ปรับ offset ทั้งหมดตาม margin ของเครื่อง

ตัวอย่าง:
```
หากเครื่องพิมพ์มี margin ซ้าย 5 มม. (14 px)
→ เพิ่มค่า *_left ทุกตัว +14 px
```

### การจัดการกับกระดาษต่อเนื่อง

สำหรับกระดาษต่อเนื่อง (Continuous Form):

1. วัดความสูงของแต่ละ form
2. ตั้งค่า Page Height ให้ตรงกับความสูงที่วัดได้
3. ตั้งค่า Paper Format ให้มี margin = 0 ทุกด้าน

ตัวอย่าง:
```
กระดาษต่อเนื่อง 8.5" x 5.5"
→ page_width = 612 px (8.5 × 72)
→ page_height = 396 px (5.5 × 72)
```

## Checklist การตั้งค่า

- [ ] วัดตำแหน่ง Header (เลขที่, วันที่)
- [ ] วัดตำแหน่งข้อมูลลูกค้า
- [ ] วัดตำแหน่งข้อมูลรถ
- [ ] วัดตำแหน่งเริ่มต้นตาราง (Table Top, Table Left)
- [ ] วัดระยะห่างระหว่างแถว (Line Height)
- [ ] วัดตำแหน่งแต่ละคอลัมน์
- [ ] วัดตำแหน่ง Footer (รวม, ลายเซ็น)
- [ ] ทดสอบพิมพ์ด้วยข้อมูลจริง
- [ ] ปรับแต่งละเอียดจนพอใจ
- [ ] บันทึก Configuration และตั้งเป็น Default

## สูตรแปลงหน่วยที่ใช้บ่อย

### มิลลิเมตร → Pixels (DPI 90)
```
pixels = มม. ÷ 25.4 × 72
```

### Pixels → มิลลิเมตร
```
มม. = pixels × 25.4 ÷ 72
```

### นิ้ว → Pixels (DPI 90)
```
pixels = นิ้ว × 72
```

### Pixels → นิ้ว
```
นิ้ว = pixels ÷ 72
```

## ตัวอย่างค่าที่ใช้งานได้จริง

### กระดาษ Letter Standard (8.5" x 11")
```
Page Width: 612 px
Page Height: 792 px
Margin: 0 px (ทุกด้าน)
DPI: 90
Font Size: 14 px
Font Family: TH Sarabun New
Line Height: 28 px
```

### กระดาษต่อเนื่อง 9.5" x 5.5"
```
Page Width: 684 px (9.5 × 72)
Page Height: 396 px (5.5 × 72)
Margin: 0 px
DPI: 90
Font Size: 12 px
Line Height: 25 px
```

## Tips สำหรับผลลัพธ์ที่ดี

1. **ใช้ฟอนต์ที่เหมาะสม**
   - TH Sarabun New: สำหรับภาษาไทย
   - Arial, Helvetica: สำหรับภาษาอังกฤษ

2. **ขนาดฟอนต์ที่แนะนำ**
   - Header/Footer: 14-16 px
   - ตาราง: 12-14 px
   - หมายเหตุ: 10-12 px

3. **ระยะห่างระหว่างแถว**
   - แนบ: 22-25 px
   - ปกติ: 26-30 px
   - โปร่ง: 31-35 px

4. **การจัดตำแหน่งข้อความ**
   - ตัวเลข: ชิดขวา (text-align: right)
   - ข้อความ: ชิดซ้าย (text-align: left)
   - รหัส: ชิดซ้าย

5. **การจัดการกับข้อความยาว**
   - ตั้งค่า max-width เพื่อป้องกันข้อความล้น
   - ใช้ text-overflow: ellipsis หากต้องการตัด
   - หรือ word-wrap: break-word หากต้องการขึ้นบรรทัดใหม่

## การแก้ไขปัญหาที่พบบ่อย

### ปัญหา: ตำแหน่งเลื่อนทุกครั้งที่พิมพ์
**สาเหตุ**: เครื่องพิมพ์มี margin ที่เปลี่ยนแปลง
**แก้ไข**: ตรวจสอบและล็อค margin ในการตั้งค่าเครื่องพิมพ์

### ปัญหา: แต่ละหน้าตำแหน่งไม่เท่ากัน
**สาเหตุ**: กระดาษไม่ได้ป้อนตรง
**แก้ไข**: ใช้ Paper Guide บนเครื่องพิมพ์

### ปัญหา: ตัวอักษรมีขนาดต่างจากที่ตั้งค่า
**สาเหตุ**: ฟอนต์ไม่ได้ติดตั้งบน server
**แก้ไข**: ติดตั้งฟอนต์ หรือเปลี่ยนไปใช้ฟอนต์ที่มีอยู่

### ปัญหา: บางช่องไม่แสดงข้อมูล
**สาเหตุ**: ไม่มีข้อมูลในฟิลด์นั้น
**แก้ไข**: ตรวจสอบและกรอกข้อมูลใน Stock Picking form
