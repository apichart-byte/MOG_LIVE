â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘     ğŸ“‹ STOCK VALUATION LOCATION - QUICK REFERENCE CARD                    â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ” MONITORING COMMANDS (à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š)                                  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

# à¸”à¸¹ log à¹à¸šà¸š real-time (à¹à¸ªà¸”à¸‡à¹€à¸‰à¸à¸²à¸°à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡)
tail -f /var/log/odoo/instance1.log | grep "SVL location"

# à¸”à¸¹ log à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” à¹à¸šà¸š real-time
tail -f /var/log/odoo/instance1.log

# à¸”à¸¹ log 100 à¸šà¸£à¸£à¸—à¸±à¸”à¸¥à¹ˆà¸²à¸ªà¸¸à¸”
tail -100 /var/log/odoo/instance1.log

# à¸„à¹‰à¸™à¸«à¸² error à¹ƒà¸™ log
grep -i "error\|exception" /var/log/odoo/instance1.log | tail -20

# à¸„à¹‰à¸™à¸«à¸² SVL location related logs
grep "SVL location" /var/log/odoo/instance1.log | tail -50

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ—„ï¸  DATABASE COMMANDS (à¸„à¸³à¸ªà¸±à¹ˆà¸‡ Database)                                 â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

# à¹€à¸‚à¹‰à¸² PostgreSQL (à¸•à¹‰à¸­à¸‡à¹ƒà¸ªà¹ˆà¸Šà¸·à¹ˆà¸­ database)
sudo -u postgres psql -d your_database_name

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ˆà¸³à¸™à¸§à¸™ SVL records
sudo -u postgres psql -d your_db -c \
  "SELECT COUNT(*) FROM stock_valuation_layer WHERE stock_move_id IS NOT NULL;"

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š SVL à¸—à¸µà¹ˆà¸¡à¸µ location
sudo -u postgres psql -d your_db -c \
  "SELECT COUNT(*) FROM stock_valuation_layer WHERE location_id IS NOT NULL;"

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š active queries
sudo -u postgres psql -d your_db -c \
  "SELECT pid, now() - query_start AS duration, state, left(query, 50)
   FROM pg_stat_activity 
   WHERE state = 'active' AND datname = 'your_db';"

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š locks
sudo -u postgres psql -d your_db -c \
  "SELECT locktype, relation::regclass, mode, granted, pid 
   FROM pg_locks 
   WHERE relation::regclass::text = 'stock_valuation_layer';"

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ”§ ODOO COMMANDS (à¸„à¸³à¸ªà¸±à¹ˆà¸‡ Odoo)                                          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸° Odoo service
sudo systemctl status odoo17

# à¸«à¸¢à¸¸à¸” Odoo
sudo systemctl stop odoo17

# à¹€à¸£à¸´à¹ˆà¸¡ Odoo
sudo systemctl start odoo17

# Restart Odoo
sudo systemctl restart odoo17

# à¸”à¸¹ Odoo log à¹à¸šà¸š real-time
sudo journalctl -u odoo17 -f

# Upgrade module
cd /opt/instance1/odoo17
./odoo-bin -c /etc/instance1.conf -d your_db \
  -u stock_valuation_location --stop-after-init

# à¹€à¸‚à¹‰à¸² Odoo shell
cd /opt/instance1/odoo17
./odoo-bin shell -c /etc/instance1.conf -d your_db

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ§ª TESTING COMMANDS (à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸—à¸”à¸ªà¸­à¸š)                                       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

# Run performance test à¹ƒà¸™ Odoo shell
cd /opt/instance1/odoo17
./odoo-bin shell -c /etc/instance1.conf -d your_db

# à¹ƒà¸™ shell à¸à¸´à¸¡à¸à¹Œ:
>>> exec(open('custom-addons/stock_valuation_location/test_performance.py').read())

# à¸«à¸£à¸·à¸­à¸—à¸”à¸ªà¸­à¸šà¹à¸šà¸šà¸‡à¹ˆà¸²à¸¢
>>> count = env["stock.valuation.layer"].search_count([("stock_move_id", "!=", False)])
>>> print(f"Total SVL with moves: {count}")

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ’¾ BACKUP & RESTORE COMMANDS (à¸„à¸³à¸ªà¸±à¹ˆà¸‡ Backup à¹à¸¥à¸° Restore)                â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

# Backup database
sudo -u postgres pg_dump -Fc your_db > backup_$(date +%Y%m%d_%H%M%S).dump

# Restore database
sudo systemctl stop odoo17
sudo -u postgres pg_restore -d your_db -c backup_file.dump
sudo systemctl start odoo17

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¸™à¸²à¸” backup
ls -lh backup_*.dump

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ” SYSTEM MONITORING (à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š)                                      â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Memory
free -h

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š CPU
top -bn1 | head -20

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Disk usage
df -h

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š process à¸‚à¸­à¸‡ Odoo
ps aux | grep odoo | grep -v grep

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š PostgreSQL process
ps aux | grep postgres | grep -v grep

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ“‚ IMPORTANT FILE PATHS (à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹„à¸Ÿà¸¥à¹Œà¸ªà¸³à¸„à¸±à¸)                              â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

Odoo Binary:       /opt/instance1/odoo17/odoo-bin
Odoo Config:       /etc/instance1.conf
Odoo Log:          /var/log/odoo/instance1.log
PostgreSQL Log:    /var/log/postgresql/postgresql-16-main.log
Module Path:       /opt/instance1/odoo17/custom-addons/stock_valuation_location

Documentation:
  - SUMMARY.txt         Quick overview
  - README_TH.md        Complete guide (Thai)
  - ACTION_PLAN.md      Quick start guide
  - FIX_SUMMARY.md      Technical details (English)
  - upgrade_module.sh   Upgrade script

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸš€ QUICK START (à¹€à¸£à¸´à¹ˆà¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸”à¹ˆà¸§à¸™)                                       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

1. BACKUP
   sudo -u postgres pg_dump -Fc your_db > backup.dump

2. UPGRADE
   cd /opt/instance1/odoo17
   ./odoo-bin -c /etc/instance1.conf -d your_db \
     -u stock_valuation_location --stop-after-init
   sudo systemctl restart odoo17

3. MONITOR
   tail -f /var/log/odoo/instance1.log | grep "SVL location"

4. RECOMPUTE (à¹ƒà¸™ Odoo UI)
   - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¹‰à¸­à¸¢: Inventory â†’ Configuration â†’ Recompute SVL Location (ORM)
   - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸¢à¸­à¸°: Inventory â†’ Configuration â†’ SVL Location â€” Fast SQL

5. VERIFY
   Inventory â†’ Reporting â†’ Stock Valuation â†’ à¸”à¸¹à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ Location

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ğŸ› TROUBLESHOOTING (à¹à¸à¹‰à¸›à¸±à¸à¸«à¸²)                                           â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

Problem: Server hang/slow
â†’ Check: tail -f /var/log/odoo/instance1.log
â†’ Check: top (CPU/Memory usage)
â†’ Fix: Reduce batch_size or limit

Problem: Query timeout
â†’ Check log for "timeout" or "statement_timeout"
â†’ Fix: Increase timeout parameter in wizard

Problem: Advisory lock busy
â†’ Check: Another recompute is running
â†’ Wait or: sudo systemctl restart odoo17

Problem: Out of memory
â†’ Check: free -h
â†’ Fix: Reduce batch_size to 500 or lower

Problem: Module errors
â†’ Check: tail -100 /var/log/odoo/instance1.log
â†’ Fix: Check Python syntax and dependencies

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ’¡ TIP: Bookmark this file for quick reference!                          â•‘
â•‘      Location: custom-addons/stock_valuation_location/QUICK_REF.txt       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
